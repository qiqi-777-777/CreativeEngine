<!--pages/career-match-result/career-match-result.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <view class="header">
    <view class="header-back" bindtap="goBack" hover-class="none">
      <text class="back-icon">â€¹</text>
    </view>
    <view class="header-title">åŒ¹é…ç»“æœ</view>
    <view class="header-placeholder"></view>
  </view>

  <!-- åŒ¹é…ç»“æœç»Ÿè®¡ -->
  <view class="result-summary">
    <view class="summary-icon">ğŸ¯</view>
    <view class="summary-title">ä¸ºæ‚¨åŒ¹é…åˆ° {{occupations.length}} ä¸ªèŒä¸š</view>
    <view class="summary-desc">æ ¹æ®æ‚¨çš„ä¸“ä¸šã€æŠ€èƒ½å’Œæ€§æ ¼ç‰¹è´¨æ¨è</view>
  </view>

  <!-- èŒä¸šåˆ—è¡¨ -->
  <scroll-view class="occupation-list" scroll-y="true">
    <view 
      wx:for="{{occupations}}" 
      wx:key="id"
      class="occupation-card"
      bindtap="onOccupationTap"
      data-id="{{item.id}}"
    >
      <view class="card-header">
        <view class="occupation-name">{{item.name}}</view>
        <view class="industry-heat heat-{{item.industryHeat}}">
          {{item.industryHeat}}
        </view>
      </view>

      <view class="card-body">
        <!-- åŒ¹é…ä¸“ä¸š -->
        <view class="info-row" wx:if="{{item.majors && item.majors.length > 0}}">
          <view class="info-label">åŒ¹é…ä¸“ä¸š</view>
          <view class="info-tags">
            <text 
              wx:for="{{item.majors}}" 
              wx:for-item="major"
              wx:key="*this"
              class="info-tag tag-major"
            >{{major}}</text>
          </view>
        </view>

        <!-- æŠ€æœ¯è¦æ±‚ -->
        <view class="info-row" wx:if="{{item.skills && item.skills.length > 0}}">
          <view class="info-label">æŠ€æœ¯è¦æ±‚</view>
          <view class="info-tags">
            <text 
              wx:for="{{item.skills.slice(0, 4)}}" 
              wx:for-item="skill"
              wx:key="*this"
              class="info-tag tag-skill"
            >{{skill}}</text>
            <text wx:if="{{item.skills.length > 4}}" class="info-tag tag-more">
              +{{item.skills.length - 4}}
            </text>
          </view>
        </view>

        <!-- æ€§æ ¼ç±»å‹ -->
        <view class="info-row">
          <view class="info-label">é€‚åˆæ€§æ ¼</view>
          <view class="personality-badge">{{item.personalityCode}}å‹</view>
        </view>

        <!-- æ¨èç†ç”± -->
        <view class="reason-row">
          <view class="reason-label">ğŸ’¡ æ¨èç†ç”±</view>
          <view class="reason-text">{{item.reason}}</view>
        </view>
      </view>

      <view class="card-footer">
        <view class="detail-btn" bindtap="viewOccupationDetail" data-occupation="{{item}}">
          æŸ¥çœ‹è¯¦æƒ… â€º
        </view>
      </view>
    </view>

    <!-- åº•éƒ¨å ä½ -->
    <view class="list-bottom">
      <text wx:if="{{occupations.length > 0}}">å·²æ˜¾ç¤ºå…¨éƒ¨ç»“æœ</text>
      <text wx:else>æš‚æ— åŒ¹é…ç»“æœ</text>
    </view>
  </scroll-view>
</view>

<!-- èŒä¸šè¯¦æƒ…å¼¹çª— -->
<view wx:if="{{showDetailModal}}" class="modal-overlay" bindtap="hideDetail">
  <view class="detail-modal" catchtap="stopPropagation">
    <view class="modal-header">
      <view class="modal-title">{{selectedOccupation.name}}</view>
      <text class="close-btn" bindtap="hideDetail">âœ•</text>
    </view>
    <scroll-view class="detail-content" scroll-y="true">
      <!-- èŒä¸šæ¦‚è¿° -->
      <view class="detail-section">
        <view class="section-title">ğŸ’¼ èŒä¸šæ¦‚è¿°</view>
        <view class="section-text">{{selectedOccupation.description || 'è¯¥èŒä¸šåœ¨è¡Œä¸šä¸­æ‰®æ¼”é‡è¦è§’è‰²ï¼Œéœ€è¦ä¸“ä¸šçŸ¥è¯†å’ŒæŠ€èƒ½ã€‚'}}</view>
      </view>

      <!-- åŒ¹é…ä¸“ä¸š -->
      <view class="detail-section" wx:if="{{selectedOccupation.majors && selectedOccupation.majors.length > 0}}">
        <view class="section-title">ğŸ“ åŒ¹é…ä¸“ä¸š</view>
        <view class="detail-tags">
          <text wx:for="{{selectedOccupation.majors}}" wx:key="*this" class="detail-tag tag-major">{{item}}</text>
        </view>
      </view>

      <!-- æŠ€æœ¯è¦æ±‚ -->
      <view class="detail-section" wx:if="{{selectedOccupation.skills && selectedOccupation.skills.length > 0}}">
        <view class="section-title">ğŸ’» æŠ€æœ¯è¦æ±‚</view>
        <view class="detail-tags">
          <text wx:for="{{selectedOccupation.skills}}" wx:key="*this" class="detail-tag tag-skill">{{item}}</text>
        </view>
      </view>

      <!-- æ€§æ ¼ç‰¹è´¨ -->
      <view class="detail-section">
        <view class="section-title">ğŸŒŸ é€‚åˆæ€§æ ¼</view>
        <view class="personality-badge-large">{{selectedOccupation.personalityCode}}å‹</view>
      </view>

      <!-- èŒä¸šå‘å±• -->
      <view class="detail-section">
        <view class="section-title">ğŸ“ˆ èŒä¸šå‘å±•</view>
        <view class="section-text">{{selectedOccupation.careerPath || 'è¯¥èŒä¸šå…·æœ‰è‰¯å¥½çš„å‘å±•å‰æ™¯ï¼Œå¯ä»¥å‘é«˜çº§å²—ä½æ™‹å‡ï¼Œè–ªèµ„å¾…é‡éšç»éªŒå¢é•¿ã€‚'}}</view>
      </view>

      <!-- æ¨èç†ç”± -->
      <view class="detail-section">
        <view class="section-title">ğŸ’¡ æ¨èç†ç”±</view>
        <view class="section-text">{{selectedOccupation.reason}}</view>
      </view>

      <!-- è¡Œä¸šçƒ­åº¦ -->
      <view class="detail-section">
        <view class="section-title">ğŸ”¥ è¡Œä¸šçƒ­åº¦</view>
        <view class="heat-level-display">
          <view class="heat-badge heat-{{selectedOccupation.industryHeat}}">
            {{selectedOccupation.industryHeat}}ç­‰çº§
          </view>
          <view class="heat-desc">
            <text wx:if="{{selectedOccupation.industryHeat === 'A'}}">éå¸¸çƒ­é—¨ï¼Œéœ€æ±‚æ—ºç››</text>
            <text wx:elif="{{selectedOccupation.industryHeat === 'B'}}">è¾ƒçƒ­é—¨ï¼Œå°±ä¸šæœºä¼šå¤š</text>
            <text wx:elif="{{selectedOccupation.industryHeat === 'C'}}">ä¸€èˆ¬ï¼Œç¨³å®šå‘å±•</text>
            <text wx:else>å†·é—¨ï¼Œç«äº‰å°</text>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>
</view>
